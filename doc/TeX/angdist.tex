
\sloppy


\title{\healpix Fortran Subroutines Overview}
\docid{angdist} \section[angdist]{ }
\label{sub:angdist}
\docrv{Version 1.3}
\author{Eric Hivon}
\abstract{This document describes the \healpix Fortran90 subroutine ANGDIST.}

\begin{facility}
{Returns the angular distance in radians between two vectors. The input vectors
do not have to be normalised. For almost colinear or anti-colinear vectors, renders
numerically more accurate results than the $\cos^{-1}$ of the scalar product.} 
{\modPixTools}
\end{facility}

\begin{f90format}
{\mylink{sub:angdist:v1}{v1}%
, \mylink{sub:angdist:v2}{v2}%
, \mylink{sub:angdist:dist}{dist}%
}
\end{f90format}

\begin{arguments}
{
\begin{tabular}{p{0.3\hsize} p{0.05\hsize} p{0.1\hsize} p{0.45\hsize}} \hline 
\textbf{name~\&~dimensionality} & \textbf{kind} & \textbf{in/out} & \textbf{description} \\ \hline
                   &   &   &                           \\ %%% for presentation
v1\mytarget{sub:angdist:v1}(3) & DP & IN & cartesian vector. \\
v2\mytarget{sub:angdist:v2}(3) & DP & IN & cartesian vector. \\
dist\mytarget{sub:angdist:dist} & DP & OUT & angular distance in radians between the 2 vectors.
\end{tabular}
}
\end{arguments}

\begin{example}
{
use healpix\_types \\
use pix\_tools,    only : angdist \\
real(DP) :: dist, one = 1.0\_dp \\
call angdist((/1,2,3/)*one, (/1,2,4/)*one, dist)  \\
print*, dist
}
{
Returns the angular distance between 2 vectors.
}
\end{example}
% \newpage
% \begin{modules}
%   \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
%  \item[\htmlref{in\_ring}{sub:in_ring}] routine to find the pixels in a certain slice of a given ring.		
%  \item[\htmlref{ring\_num}{sub:ring_num}] function to return the ring number corresponding to the coordinate $z$
%   \end{sulist}
% \end{modules}

\begin{related}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
  \item[\htmlref{ang2vec}{sub:ang2vec}] converts the position angles of a point on the sphere 
into its 3D position vector.
  %\item[\htmlref{angdist}{sub:angdist}] computes the angular distance between 2 vectors
  \item[\htmlref{vec2ang}{sub:vec2ang}] converts the 3D position vector of point into its position
  angles on the sphere.
  \item[\htmlref{vect\_prod}{sub:vect_prod}] computes the vector product between two 3D vectors
  \end{sulist}
\end{related}

\rule{\hsize}{2mm}

\newpage
