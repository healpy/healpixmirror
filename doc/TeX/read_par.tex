
\sloppy


\title{\healpix Fortran Subroutines Overview}
\docid{read\_par} \section[read\_par]{ }
\label{sub:read_par}
\docrv{Version 2.0}
\author{Frode K.~Hansen, Eric Hivon}
\abstract{This document describes the \healpix Fortran90 subroutine READ\_PAR.}

\begin{facility}
{This routine reads the `NSIDE', `TFIELDS' , `MAX-LPOL', and optionally `MAX-MPOL'
  keywords from a FITS-file. These keywords desribe $N_{side}$, number of
  datasets (maps) and maximum multipole $\ell$ (order) and $m$ (degree) value
  for the file. If a keyword is not found in the FITS file, a value of -1 is
  returned instead. The file could eg. be a \healpix map, or a set of $a_{lm}$  or precomputed $P_{lm}(\theta)$}
{\modFitstools}
\end{facility}

\begin{f90format}
{ \mylink{sub:read_par:filename}{filename}%
, \mylink{sub:read_par:nside}{nside}%
, \mylink{sub:read_par:lmax}{lmax}%
, \mylink{sub:read_par:tfields}{tfields}%
 \optional{[, \mylink{sub:read_par:mmax}{mmax}%
]} }
\end{f90format}

\begin{arguments}
{
\begin{tabular}{p{0.35\hsize} p{0.05\hsize} p{0.05\hsize} p{0.45\hsize}} \hline  
\textbf{name~\&~dimensionality} & \textbf{kind} & \textbf{in/out} & \textbf{description} \\ \hline
                   &   &   &                           \\ %%% for presentation
filename\mytarget{sub:read_par:filename}(LEN=\filenamelen) & CHR & IN & filename of the FITS file. \\
nside\mytarget{sub:read_par:nside} & I4B & OUT & `NSIDE' keyword value from the FITS header.\\
lmax\mytarget{sub:read_par:lmax} & I4B & OUT & `MAX-LPOL' keyword value from the FITS header. \\
tfields\mytarget{sub:read_par:tfields} & I4B & OUT & `TFIELDS' keyword value from the FITS header. \\ 
\optional{mmax\mytarget{sub:read_par:mmax}} (OPTIONAL) & I4B & OUT & `MAX-MPOL' keyword value from the FITS header. \\
\end{tabular}
}
\end{arguments}

\begin{example}
{
call read\_par('plm\_128p.fits', nside, lmax, nhar)  \\
}
{
Checks the $N_{side}$ and maximum $\ell$ value used for the precomputed $P_{\ell
  m}(\theta)$ that are stored in the file `plm\_128p.fits'. If the file also contains tensor harmonics, nhar is returned with the value 3, otherwise it is 1.
}
\end{example}
%%%\newpage
\begin{modules}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
  \item[\textbf{fitstools}] module, containing:
  \item[printerror] routine for printing FITS error messages.
  \item[\textbf{cfitsio}] library for FITS file handling.		
  \end{sulist}
\end{modules}

\begin{related}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
  \item[synfast, plmgen] executables that produce FITS-files with keywords relevant to this routine.
  \end{sulist}
\end{related}

\rule{\hsize}{2mm}

\newpage
