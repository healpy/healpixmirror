
\sloppy


\title{\healpix Fortran Subroutines Overview}
\docid{median*} \section[median*]{ }
\label{sub:median}
\docrv{Version 2.0}
\author{Eric Hivon}
\abstract{This document describes the \healpix Fortran90 subroutine MEDIAN*.}

\begin{facility}
{This function computes the median of a data set}
{\modStatistics}
\end{facility}

\begin{f90function}
{\mylink{sub:median:data}{data}%
 [,~\mylink{sub:median:badval}{badval}%
, \mylink{sub:median:even}{even}%
]}
\end{f90function}

\begin{arguments}
{
\begin{tabular}{p{0.30\hsize} p{0.05\hsize} p{0.05\hsize} p{0.50\hsize}} \hline  
\textbf{name~\&~dimensionality} & \textbf{kind} & \textbf{in/out} & \textbf{description} \\ \hline
                   &   &   &                           \\ %%% for presentation
var & SP/ DP & OUT & median of the data set, defined as the middle number (or
                   the average of the 2 middle numbers) once the valid data points are
                   sorted in monotonous order\\
data\mytarget{sub:median:data}(:) & SP/ DP & IN & data set \\
badval\mytarget{sub:median:badval} \hskip 3cm (OPTIONAL) & SP/ DP & IN & sentinel value given to bad data points. Data points with this
                   value will be ignored during calculation of the median. If
                   not set, all points will be considered. {\bf Do not set to 0!}.\\
even\mytarget{sub:median:even} \hskip 4cm (OPTIONAL) & LGT & IN & if set to {\tt .true.} and the number of
                   valid data points is even, will output the average of the 2
                   middle points (which doubles the calculation time). If the
                   number of points is odd, the single middle point is output
                   and this keyword is ignored.
\end{tabular}
}
\end{arguments}
%%\newpage

\begin{example}
{
use statistics, only: median \\
... \\
med = median(map, even=.true.)  \\
}
{
Outputs in {\tt med} the median of {\tt map}
}
\end{example}

\begin{modules}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
  \item[\textbf{m\_indmed}] module of the Orderpack 2.0 package, written by:
  Michel Olagnon,  \htmladdnormallink{http://www.fortran-2000.com/rank/}{http://www.fortran-2000.com/rank/},
  also available in \htmladdnormallink{\modIndmed}{\srcurl\modIndmed}
  \item[indmed] routine of \texttt{m\_indmed} to output rank of median
  \end{sulist}
\end{modules}

\begin{related}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
  \item[\htmlref{compute\_statistics}{sub:compute_statistics}] routine min, max,
  absolute deviation, and first four order moments of a data set
  \end{sulist}
\end{related}

\rule{\hsize}{2mm}

\newpage
