\sloppy
\docid{plm\_gen}\section[plm\_gen]{ }
\label{sub:plm_gen}
\docrv{Version 2.0}
\author{Eric Hivon}
\abstract{This document describes the \healpix Fortran90 subroutine PLM\_GEN.}

\begin{facility}
{This routine computes the latitude dependent part $\lambda_{\ell m}$ of the
  spherical harmonics ($Y_{\ell m}(\theta,\phi) = \lambda_{\ell m}(\theta) e^{i m \phi}$) of spin 0 and 2
  (see \healpix primer)
  used to synthetize or analyze \healpix maps of temperature and polarisation.
  Since version 2.20, which introduced optimized algorithms for spherical
  harmonic transforms, it has become obsolete and should no longer be used.}
{\modAlmTools}
\end{facility}

\begin{f90format}
{nsmax, nlmax, nmmax, plm}
\end{f90format}

\begin{arguments}
{
\begin{tabular}{p{0.4\hsize} p{0.05\hsize} p{0.1\hsize} p{0.35\hsize}} \hline  
\textbf{name~\&~dimensionality} & \textbf{kind} & \textbf{in/out} & \textbf{description} \\ \hline
                   &   &   &                           \\ %%% for presentation
nsmax & I4B & IN & The $\nside$ value for which to compute the $\lambda_{\ell m}$. \\
nlmax & I4B & IN & The maximum multipole order $\ell$ of the generated $\lambda_{lm}$. \\
nmmax & I4B & IN & The maximum degree $m$ of the generated $\lambda_{lm}$. \\
plm(0:n\_plm-1, 1:p) & DP & OUT & The $\lambda_{lm}$ values, either for temperature only
                   ($p=1$) or temperature and polarisation ($p=3$). The number
                    of $\lambda_{\ell m}$ is n\_plm =
                    nsmax*(nmmax+1)*(2*nlmax-nmmax+2). They are stored in the
                    order of increasing order $\ell$, increasing degree $m$, for
                    all the \healpix ring colatitudes $\theta$ from North Pole to Equator, ie
 		   $\lambda_{00}(\theta_1)$, $\lambda_{10}(\theta_1)$, $\lambda_{20}(\theta_1)$,
                    \ldots, $\lambda_{11}(\theta_1)$, $\lambda_{21}(\theta_1)$;
                    \ldots,  $\lambda_{00}(\theta_2)$ \ldots \\
\end{tabular}
}
\end{arguments}

\begin{example}
{
use healpix\_types \\
use alm\_tools, only : plm\_gen \\
integer(I4B) :: nside, lmax, mmax, n\_plm\\
real(DP), dimension(:,:), allocatable :: plm \\
\ldots \\
nside=256 ; lmax=512 ; mmax=lmax\\
npix=nside2npix(nside)\\
n\_plm=nside*(mmax+1)*(2*lmax-mmax+2)\\
allocate(plm(0:n\_plm-1,1:3))\\
\ldots \\
call \thedocid(nside, lmax, mmax, plm)  \\
}
{
Computes the spherical harmonics for temperature and polarisation for $N_{side}= 256$, up to 512 in $\ell$ and $m$.
}
\end{example}

\begin{modules}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
  \item[compute\_lam\_mm, get\_pixel\_layout, ]
  \item[gen\_lamfac,gen\_mfac, gen\_normpol, ] 
  \item[gen\_recfac, init\_rescale, l\_min\_ylm] Ancillary routines used
  for $\lambda_{\ell m}$ recursion
  \item[\textbf{misc\_utils}] module, containing:
  \item[assert\_alloc] routine to print error message, when an array can not be
  allocated properly
  \end{sulist}
\end{modules}

\begin{related}
  \begin{sulist}{} %%%% NOTE the ``extra'' brace here %%%%
   \item[\htmlref{alm2map}{sub:alm2map}] routine generating maps of temperature
   and polarisation from their $a_{\ell m}$ that can use precomputed $\lambda_{\ell
   m}$ generated by \thedocid
   \item[\htmlref{map2alm}{sub:map2alm}] routine analysing maps of temperature
   and polarisation that can use precomputed $\lambda_{\ell
   m}$ generated by \thedocid
  \item[plmgen] executable using \thedocid\ to compute the $\lambda_{\ell m}$ and
  writting them on disc 
%%   \item[anafast] executable that may use the $\lambda_{\ell m}$ produced by \thedocid\ to analyse maps
%%   \item[smoothing] executable that may use the $\lambda_{\ell m}$ produced by \thedocid\ to smooth maps
%%   \item[synfast] executable that may use the $\lambda_{\ell m}$ produced by \thedocid\ to synthesize maps.
  \end{sulist}
\end{related}

\rule{\hsize}{2mm}

\newpage
